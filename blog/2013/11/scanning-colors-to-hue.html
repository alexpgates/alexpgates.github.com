<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Scanning Colors to PhilipsÂ Hue</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="http://alexpgates.com/theme/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="http://alexpgates.com/theme/css/bootstrap-responsive.min.css" type="text/css" />
    <link rel="stylesheet" href="http://alexpgates.com/theme/css/base.css" type="text/css" />
<link rel="stylesheet" href="http://alexpgates.com/theme/css/article.css" type="text/css" />
    <link rel="stylesheet" href="http://alexpgates.com/theme/css/typogrify.css" type="text/css" />
    <link rel="stylesheet" href="http://alexpgates.com/theme/css/pygment.css" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Arvo:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    
    
    <link href="http://alexpgates.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Alex P. Gates Atom Feed" />
    <link rel="shortcut icon" href="/favicon.ico?v=4" />

    <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
 </head>
<body>
<div class="wrap">
<div class="container-fluid">
    <div class="row-fluid">

        <div class="span4 pagination-centered side-column" id="side-column">
            <div class="pagination-centered">
                <div id="alex-photo"><a href="http://alexpgates.com/">
                    <img class="me" src="http://alexpgates.com/theme/img/alex-medium.png" alt="Handsome Photo of Alex"></a>
                </div>
            </div>
            <div>
                <h1 class="sitename">Alex P. Gates</h1>
                
                <div class="subtitle">
<p>works on the internet</p> 
 <span class="amp">&amp;</span><div class="omaha"><small>lives in Omaha.</small></div>                    <div class="social">
                        <p><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#108;&#101;&#120;&#64;&#119;&#104;&#97;&#116;&#99;&#104;&#101;&#101;&#114;&#46;&#99;&#111;&#109;"><i title="email" class="fa fa-envelope"></i></a><a href="http://twitter.com/alexpgates"><i title="twitter" class="fa fa-twitter"></i></a><a href="http://github.com/alexpgates"><i title="github" class="fa fa-github-alt"></i></a><a href="http://linkedin.com/in/alexpgates"><i title="linkedin" class="fa fa-linkedin"></i></a><a href="/feeds/all.atom.xml"><i title="feed" class="fa fa-rss"></i></a></p>
                        <div class="call top-padding">
                            <a class="btn btn-inverse" href="tel:1-415-692-1835"><i class="icon-phone"></i>&nbsp;&nbsp;&nbsp;Call Alex</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
            <hr class="top-hr">
        </div><!-- /side panel-->

        <div class="main-content span7">
<section id="content" class="body">
  <article>

    <header>
      <h1 class="entry-title">Scanning Colors to Philips&nbsp;Hue</h1>
    </header>
    <h5 class="entry-date-tags">Nov&nbsp;17,&nbsp;2013&nbsp;&nbsp;&bull;&nbsp;&nbsp;<a href="http://alexpgates.com/blog/tag/philips-hue">#Philips Hue</a>&nbsp;<a href="http://alexpgates.com/blog/tag/php">#PHP</a>&nbsp;<a href="http://alexpgates.com/blog/tag/color-quantization">#color quantization</a>&nbsp;</h5>

    <div class="entry-content">
      <div class="videoWrapper">
<iframe src="//player.vimeo.com/video/100126411?title=0&amp;byline=0&amp;portrait=0" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</div>

<h3>What is&nbsp;this?</h3>
<p><a href="https://github.com/alexpgates/color-scan">color-scan</a> grabs the dominant color(s) from images and passes the color(s) to <a href="https://www.meethue.com/en-US">Philips Hue lights</a>. You can decide if you want to send the main color to a group of lights, or individual colors to individual lights. It also works with scanned photos, of course, or with any jpeg that you drop in the directory. You don&#8217;t actually <em>need</em> the&nbsp;scanner.</p>
<p>You can can decide whether you want the main dominant color on all your lights <code>$color_mode = 'single';</code>, or if you&#8217;d like to grab a palette of colors to send to individual bulbs <code>$color_mode = 'multi';</code>. The example in the video demonstrates using the &#8220;single&#8221; color&nbsp;mode.</p>
<h3>How does it&nbsp;work?</h3>
<p>When the process script is called, it grabs the latest image from a directory. Color Thief handles the color quantization and provides <span class="caps">RGB</span> colors. <span class="caps">RGB</span> is converted to the the xy color space, then sent to your Hue&nbsp;bridge.</p>
<h3>Where can I get&nbsp;this?</h3>
<p>Please <a href="https://github.com/alexpgates/color-scan">fork it</a> from&nbsp;GitHub!</p>
<h3>How do the settings&nbsp;work?</h3>
<div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$color_mode</span> <span class="o">=</span> <span class="s1">&#39;multi&#39;</span><span class="p">;</span> <span class="c1">// &quot;multi&quot; or &quot;single&quot;</span>
<span class="c1">// &quot;multi&quot; uses different colors for each light (defined in $light_ids), </span>
<span class="c1">// &quot;single&quot; uses the most dominant color found in the image for a Hue group (defined in $group_id)</span>

<span class="nv">$light_ids</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">);</span> 
<span class="c1">// ids of your Hue lights that you want to use with color-scan</span>
<span class="c1">// Grab these from your bridge. http://developers.meethue.com/1_lightsapi.html</span>

<span class="nv">$brightness</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span>
<span class="c1">// 0 - 255 http://developers.meethue.com/1_lightsapi.html</span>

<span class="nv">$group_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="c1">// must be set  if using single color mode;</span>
<span class="c1">// Grab this from your bridge. http://developers.meethue.com/2_groupsapi.html</span>

<span class="nv">$path</span> <span class="o">=</span> <span class="s2">&quot;/path/to/your/images/&quot;</span><span class="p">;</span>
<span class="c1">// directory where you want to look for an image to process</span>

<span class="nv">$bridge</span> <span class="o">=</span> <span class="s1">&#39;x.x.x.x&#39;</span><span class="p">;</span> 
<span class="c1">// ip address of your internal bridge</span>

<span class="nv">$hue_key</span> <span class="o">=</span> <span class="s1">&#39;hue-user&#39;</span><span class="p">;</span> 
<span class="c1">// valid api user</span>

<span class="c1">//$debug = &#39;debug&#39;; // uncomment this for some debug info</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<p><small>*Note: color-scan doesn&#8217;t handle registering a user on your bridge. You&#8217;ll need to handle that <a href="http://developers.meethue.com/4_configurationapi.html">on your own</a>.</small></p>
<h3>How do I use&nbsp;this?</h3>
<p>After adjusting the settings to fit your Hue setup, drop a jpeg in the directory you defined in <code>$path</code>. Then run&nbsp;process.php.</p>
<h3>Why did you make this (totally useless)&nbsp;thing?</h3>
<p>For fun, of course! I wanted to build something that would allow me to scan an image (or a piece of paper with some color) and have my lights change to match the dominant color(s) in the scanned image with the press of a&nbsp;button.</p>
<p>I pulled that all together with color-scan + the addition of a folder action in <span class="caps">OS</span> X that runs process.php when a new file is added to the directory I defined in $path. I have a profile in the Fujitsu settings that dumps new images in this directory, so it&#8217;s all triggered by pressing the button on my&nbsp;scanner.</p>
<p><img alt="'OS X Folder Action setup'" src="https://dl.dropboxusercontent.com/u/2227623/blog-images/XNMDVF-Screen_Shot_2013-11-22_at_3.03.28_PM.png" /></p>
<h3>Can&#8217;t you already do this with digital images and the Hue&nbsp;app?</h3>
<p>Yes. But I just got this fancy new scanner and I wanted to hook it up to my light&nbsp;bulbs!</p>
<h3>Dependencies</h3>
<ul>
<li>This uses a <a href="https://github.com/ksubileau/color-thief-php">color-thief-php</a> by <a href="http://kevinsubileau.fr">Kevin Subileau</a>, which is a port of <a href="https://github.com/lokesh/color-thief," title="Color Thief">Color Thief</a> written by <a href="http://lokeshdhakar.com/">Lokesh&nbsp;Dhakar</a></li>
<li><span class="caps">PHP</span> (Only tested in 5.3.6) with&nbsp;cURL</li>
</ul>
<h3>License</h3>
<p>color-scan is <span class="caps">MIT</span>&nbsp;licensed.</p>
<p>Color Thief has it&#8217;s own license, so check <a href="https://github.com/lokesh/color-thief">here</a> and <a href="https://github.com/ksubileau/color-thief-php">here</a>.</p>
<h3>Want more&nbsp;Hue?</h3>
<p>Here&#8217;s an <a href="/blog/2013/04/voice-controlled-hue.html">earlier post</a> about using voice commands and weather data to control these&nbsp;lights.</p>
    </div>

  </article>
</section>
        </div>
    </div>
</div>
</div>
        <footer>
            <div class="row-fluid">
                <div class="span5 offset1">
                    <h5>About Alex</h5>
                    <p><span class="bold">Alex P. Gates</span> is a <span class="bold">web developer</span>, <span class="bold">web strategist</span>, and <span class="bold">technophile</span> based in Omaha, Nebraska.</p>
                </div>
                <hr class="footer-hr">
                <div class="span4 offset1 projects">
                    <h5>Projects</h5>
                        <ul>
                            <li><a href="http://packdog.com">Pack</a></li>
                            <li><a href="http://whatcheer.com">What Cheer</a>
                                <ul>
                                    <li><a href="http://iliveinomaha.com">I Live in Omaha</a></li>
                                    <li><a href="http://bumblephone.com">Bumble</a></li>
                                    <li><a href="http://iloveinomaha.com">I Love in Omaha</a></li>
                                    <li><a href="http://selectiveperspectivedetectiveobjective.com/">SPDO</a></li>
                                    <li><a href="http://iliveinomaha.com/hotorcold">Hot or Cold</a></li>
                                </ul>
                            </li>
                            <li><a href="http://schools.opennebraska.io/">HackOmaha 2013: Visualizing School Enrollment</a></li>
                        </ul>
                </div>
            </div>
            <hr class="footer-hr">
            <div class="footer-social row-fluid">
                <div class="span12 pagination-centered">
                    <p><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#108;&#101;&#120;&#64;&#119;&#104;&#97;&#116;&#99;&#104;&#101;&#101;&#114;&#46;&#99;&#111;&#109;"><i title="email" class="fa fa-envelope fa-2x"></i></a><a href="http://twitter.com/alexpgates"><i title="twitter" class="fa fa-twitter fa-2x"></i></a><a href="http://github.com/alexpgates"><i title="github" class="fa fa-github fa-2x"></i></a><a href="http://linkedin.com/in/alexpgates"><i title="linkedin" class="fa fa-linkedin fa-2x"></i></a><a href="/feeds/all.atom.xml"><i title="feed" class="fa fa-rss fa-2x"></i></a></p>
                    <div class="call top-padding">
                        <a class="btn btn-inverse" href="tel:1-415-692-1835"><i class="fa fa-phone"></i>Call Alex</a>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12 pagination-centered" style="padding-top:40px">
                    <p><small>Built with <a href="http://daringfireball.net/projects/markdown/" target="_blank">Markdown</a>, <a href="http://docs.getpelican.com/en/latest/" target="_blank">Pelican</a>, <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>, and <a href="http://twitter.github.io/bootstrap/index.html">Bootstrap</a> and hosted on <a href="http://github.com">Github</a>.</small><br><a href="http://siliconprairiebuilt.com" target="_blank"><img src="http://alexpgates.com/theme/img/footer-black-sm.png" alt="Silicon Prairie Built"></a></p>
                </div>
            </div>
        </footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39747483-2', 'alexpgates.com');
  ga('send', 'pageview');

</script>
</body>
</html>