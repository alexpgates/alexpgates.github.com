<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Strangers, Please Control my Kitchen Lights</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="http://alexpgates.com/theme/css/bootstrap.min.css" type="text/css"><link rel="stylesheet" href="http://alexpgates.com/theme/css/bootstrap-responsive.min.css" type="text/css"><link rel="stylesheet" href="http://alexpgates.com/theme/css/article.css?v2" type="text/css"><link rel="stylesheet" href="http://alexpgates.com/theme/css/typogrify.css" type="text/css"><link rel="stylesheet" href="http://alexpgates.com/theme/css/pygment.css" type="text/css"><link href="http://fonts.googleapis.com/css?family=Arvo:400,700,400italic,700italic|PT+Sans:400,700" rel="stylesheet" type="text/css"><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"><link rel="stylesheet" href="http://alexpgates.com/theme/css/base.css?v7" type="text/css"><meta property="og:type" content="article"><meta property="og:title" content="Strangers, Please Control my Kitchen Lights"><meta property="og:description" content="It occurred to me that I should probably let strangers from the internet control the lights in my kitchen. (Because why not?)"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://alexpgates.com/images//kitchencolors-header.jpg"><link href="http://alexpgates.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Alex P. Gates Atom Feed"><link rel="shortcut icon" href="/favicon.ico?v=4"><!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--></head><body><div class="wrap"><div class="container-fluid"><div class="row-fluid"><div class="span4 pagination-centered side-column" id="side-column"><div class="pagination-centered" id="side-photo"><div id="alex-photo"><a href="http://alexpgates.com/"><img class="me" src="http://alexpgates.com/theme/img/alex-medium.png" alt="Handsome Photo of Alex"></a></div></div><div><h1 class="sitename">Alex P. Gates</h1><span class="subtitle"><p class="side-desc">Technology Consultant</p><p class="amp">&amp;</p><p class="side-desc">Freelance Web Developer</p><ul class="sidebar-contact"><li><a href="mailto:alexpgates@gmail.com">alexpgates@gmail.com</a></li><li><a href="tel:+14025147535">402-514-7535</a></li></ul></span><span class="subtitle-mobile"><p>Technology Consultant <span class="amp">&amp;</span> Freelance Web&nbsp;Developer</p></span></div><div class="clearfix"></div><hr class="top-hr"></div><div class="main-content span7"><section id="content" class="body"><article><header><h1 class="entry-title">Strangers, Please Control my Kitchen&nbsp;Lights</h1></header><h5 class="entry-date-tags">Aug&nbsp;10,&nbsp;2014&nbsp;&nbsp;&bull;&nbsp;&nbsp;<a href="http://alexpgates.com/blog/tag/philips-hue">#Philips Hue</a>&nbsp;<a href="http://alexpgates.com/blog/tag/nodejs">#Node.js</a>&nbsp;<a href="http://alexpgates.com/blog/tag/raspberry-pi">#Raspberry Pi</a>&nbsp;<a href="http://alexpgates.com/blog/tag/twitter">#Twitter</a>&nbsp;</h5><div class="entry-content"><div class="row text-center span12"><img src="/images/kitchencolors-header.jpg" class="hero" alt="kitchencolors" width="650"></div><h3>It occurred to me that I should probably let strangers from the internet control the lights in my&nbsp;kitchen.</h3><p><em>(Because why&nbsp;not?)</em> </p><h4>And now you can, by tweeting to <a href="http://twitter.com/kitchencolors">@kitchencolors</a>.</h4><hr><p>During our recent kitchen remodel, I made a special point to build in power outlets for a couple sets of <a href="http://meethue.com/en-us/friends-of-hue/lightstrips/">Philips Hue LightStrips</a>. </p><p>With the <a href="https://ifttt.com/hue">Philips Hue <span class="caps">IFTTT</span> channel</a>, these lights have been set to turn on around sundown and turn off at&nbsp;11pm.</p><p>That&#8217;s perfectly cool and all, but lately I&#8217;ve been itching to <em>build</em> something fun to take advantage of the bigger <span class="caps">RGB</span> color range available with the&nbsp;LightStrips.</p><p>Finally last night it dawned on me that I should let the internet choose the colors of my kitchen&nbsp;lights. </p><h3>Before I began, I wrote down these three&nbsp;goals:</h3><ol><li>Make it fast! (No waiting on <span class="caps">IFTTT</span> or anything like&nbsp;that.)</li><li>Step out of my <span class="caps">PHP</span> comfort&nbsp;zone.</li><li>Power this with my <a href="http://www.raspberrypi.org/">Raspberry Pi</a>.</li></ol><hr><h4>Make it&nbsp;fast!</h4><p>The Philips Hue <span class="caps">API</span> works by making <span class="caps">HTTP</span> requests to a bridge connected to your local network. That, in itself, created some&nbsp;limitations. </p><p>One thought was to schedule a cron job on a machine in my home network to run every minute and hit an endpoint on a public webserver to check for new color changes. That approach seemed pretty wasteful (and still pretty slow, honestly). That, and it&#8217;d require building a front-end interface to interact with the&nbsp;app.</p><p>So then I thought about using Twitter to handle the color requests, and realized this would a perfect time to try the <a href="https://dev.twitter.com/docs/streaming-apis/streams/user">user stream <span class="caps">API</span></a>, since it seems to be nearly&nbsp;instantaneous.</p><hr><h4>Step out of my <span class="caps">PHP</span> comfort&nbsp;zone</h4><p>Next I started thinking about how I&#8217;d want people to make the color requests. Since <a href="http://developers.meethue.com/">the Hue <span class="caps">API</span></a> accepts X <span class="amp">&amp;</span> Y coordinates from the <a href="http://en.wikipedia.org/wiki/CIE_1931_color_space"><span class="caps">CIE</span> color space</a>, I knew we would need an easy way to translate casual color requests without being too limiting. In other words, I didn&#8217;t want to simply hard-code 20 or so colors, because <a href="http://www.newscenter.philips.com/main/standard/news/press/2013/20130807-philips-expands-the-smart-world-of-hue.wpd#.U-gnuNNdU1g">Hue actually supports <em>16 million</em> colors</a>. </p><p>The <a href="https://github.com/bahamas10/hue-cli">Hue command-line interface by bahamas10</a> accepts <span class="caps">CSS</span> color names and also hex color values. This tool runs on Node.js, and I was already familiar with it because I&#8217;ve actually been using it for a few months to control my lights from the command-line. (<a href="/images//prof.gif"><span class="caps">HOYVIN</span>-<span class="caps">GLAVIN</span>!</a>).</p><p><strong>I don&#8217;t have much experience with Node.js, so this seemed like a perfect opportunity to try something&nbsp;new.</strong></p><p>The next task was to figure out how to consume the Twitter user stream <span class="caps">API</span> from Node.js. After a little digging, I came across <a href="https://github.com/outadoc/twitter-mentions-pushover">twitter-mentions-pushover</a> by <a href="http://dev.outadoc.fr/">Baptist Candellier</a>. This provided everything I needed to consume my user stream. I just trimmed off the part in the script that sends the tweet to Pushover, removed any @mentions and # symbols, and added the <span class="caps">NPM</span> module <a href="https://www.npmjs.org/package/exec">exec()</a> to send the color command to hue-cli. All said and done, I <em>maybe</em> wrote 6 lines of&nbsp;code.</p><hr><h4>Power this with my Raspberry&nbsp;Pi</h4><p>Since the node process needs to be constantly running to consume the Twitter stream and pass requests to the Hue bridge, I wanted to keep my power usage low. The Raspberry Pi runs on a simple 5V power supply, and it&#8217;s completely silent. It runs headless and sits nicely next to my modem, router, and hue&nbsp;bridge. </p><div class="row text-center"><img src="/images/rpi.jpg" class="margin" width="500"></div><p>Installing a fresh <a href="http://www.raspberrypi.org/downloads/">Raspbian Wheezy image</a> was a breeze. Then I followed <a href="https://learn.adafruit.com/raspberry-pi-hosting-node-red/setting-up-node-dot-js">this guide</a> to set up&nbsp;Node.js.</p><p>From <span class="caps">NPM</span>, I installed <a href="https://www.npmjs.org/package/hue-cli">hue-cli</a> and <a href="https://www.npmjs.org/package/exec">exec</a>. The other dependencies (<a href="https://www.npmjs.org/package/entities">entities</a>, <a href="https://www.npmjs.org/package/ntwitter">ntwitter</a>, and <a href="https://www.npmjs.org/package/request">request</a>) shipped with <a href="https://github.com/outadoc/twitter-mentions-pushover">twitter-mentions-pushover</a>.</p><p>Finally, I created a fork of twitter-mentions-pushover and renamed the project <a href="https://github.com/alexpgates/kitchencolors">Kitchencolors</a>. </p><hr><h3>See it in&nbsp;action!</h3><p>I made a hilariously dramatic video to show how quickly tweets are processed as&nbsp;color.</p><div class="videoWrapper"><iframe src="//player.vimeo.com/video/103095002?title=0&amp;byline=0&amp;portrait=0" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div><p><br><span class="caps">LOL</span>. It was either that or the sound of my dishwasher&nbsp;running.</p><hr><h3>Give it a&nbsp;try!</h3><p>To change the colors of my kitchen lights, just send a tweet to <a href="http://twitter.com/kitchencolors">@kitchencolors</a> with a css color name <em>or</em> a hex&nbsp;value.</p><div class="row text-center"><img src="/images/tweet-to-kitchencolors.png" width="438"></div><p>So far, I&#8217;ve had people from all over the United States, England, Brazil, New Zealand, and Panama decide what color my kitchen should&nbsp;be.</p><hr><h3>Open up your Hue lights to&nbsp;strangers</h3><p>It&#8217;s still pretty rough around the edges, but you can <a href="https://github.com/alexpgates/kitchencolors">download the source here</a>! Future updates will include better color parsing to pull colors out of tweets that contain other text. If that sounds like fun, or if you have other feature ideas, please send me a pull&nbsp;request!</p></div></article></section></div></div></div></div><footer><div class="row-fluid"><div class="span5 offset1"><h2>Alex P. Gates</h2><p><span class="bold">Alex is a technology consultant &amp; freelance web developer based in Omaha, Nebraska.</p><h4>Blog Topics</h4><p><a href="http://alexpgates.com/blog/tag/alfred">Alfred</a>, <a href="http://alexpgates.com/blog/tag/bootstrap">Bootstrap</a>, <a href="http://alexpgates.com/blog/tag/coffee">Coffee</a>, <a href="http://alexpgates.com/blog/tag/color-quantization">Color Quantization</a>, <a href="http://alexpgates.com/blog/tag/github">Github</a>, <a href="http://alexpgates.com/blog/tag/javascript">JavaScript</a>, <a href="http://alexpgates.com/blog/tag/life">Life</a>, <a href="http://alexpgates.com/blog/tag/mac">Mac</a>, <a href="http://alexpgates.com/blog/tag/nodejs">Node.js</a>, <a href="http://alexpgates.com/blog/tag/pack">Pack</a>, <a href="http://alexpgates.com/blog/tag/pelican">Pelican</a>, <a href="http://alexpgates.com/blog/tag/philips-hue">Philips Hue</a>, <a href="http://alexpgates.com/blog/tag/php">PHP</a>, <a href="http://alexpgates.com/blog/tag/productivity">Productivity</a>, <a href="http://alexpgates.com/blog/tag/raspberry-pi">Raspberry Pi</a>, <a href="http://alexpgates.com/blog/tag/smart-lighting">Smart Lighting</a>, <a href="http://alexpgates.com/blog/tag/sms">SMS</a>, <a href="http://alexpgates.com/blog/tag/speaking">Speaking</a>, <a href="http://alexpgates.com/blog/tag/twilio">Twilio</a>, <a href="http://alexpgates.com/blog/tag/twitter">Twitter</a></p></div><hr class="footer-hr"><div class="span5 offset1 footer-right"><h4 class="top-hug"><a href="mailto:alexpgates@gmail.com?subject=Hello%20Alex!">Email Me</a></h4><p>Interested in working together, or just meeting for a cup of coffee? <a href="mailto:alexpgates@gmail.com?subject=Hello%20Alex!">Email me</a>. I'd love to meet&nbsp;you.</p><h4><a href="mailto:alex@whatcheer.com?subject=Come%20Talk!">Invite Me To Speak</a></h4><p>I enjoy talking about email marketing, distributed work culture, The Internet of Things, and brand gamification. <a href="mailto:alex@whatcheer.com?subject=Come%20Talk!">Let's&nbsp;chat</a>.</p><h4>Elsewhere</h4><p>I'm on the internet! Find me on <a href="http://twitter.com">Twitter</a>, <a href="http://github.com/alexpgates">Github</a>, <a href="http://packdog.com/human/alex">Pack</a>, <a href="http://instagram.com/alexpgates">Instagram</a>, and&nbsp;<a href="http://www.linkedin.com/in/alexpgates">LinkedIn</a>.</p></div></div><hr class="footer-hr"><div class="row-fluid"><div class="span12 pagination-centered built"><p>Built with <a href="http://daringfireball.net/projects/markdown/" target="_blank">Markdown</a>, <a href="http://docs.getpelican.com/en/latest/" target="_blank">Pelican</a>, <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>, and <a href="http://twitter.github.io/bootstrap/index.html">Bootstrap</a> and hosted on&nbsp;<a href="https://pages.github.com/">Github Pages</a>.</p></div></div><div class="row-fluid"><div class="span12 pagination-centered spb"><p><a href="http://siliconprairiebuilt.com" target="_blank"><img src="http://alexpgates.com/theme/img/footer-black-sm.png" alt="Silicon Prairie Built"></a></p></div></div></footer><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39747483-2', 'alexpgates.com');
  ga('send', 'pageview');

</script></body></html>